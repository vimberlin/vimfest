<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;"/>
    <% data.global.meta and data.global.meta.each do |name, content| %>
      <%= tag :meta, :name => name, :content => content %>
    <% end %>

    <title><%= current_page.data.title || data.global.title || "Vimfest" %></title>

    <% data.styles.css.each do |style| %>
      <%= stylesheet_link_tag style %>
    <% end %>
    <%= stylesheet_link_tag "main" %>
    <%= feed_tag :atom, "#{blog.options.prefix.to_s}/feed.xml", title: "Atom Feed" %>
  </head>

  <body class="<%= page_classes %>" data-spy="scroll" data-target=".navbar" data-offset="50">
    <%= partial "partials/header_navigation" %>

    <%= yield %>
    <% data.styles.scripts.each do |script| %>
    <%= javascript_include_tag script %>
    <% end %>
<script>

  var mymap = L.map('mapid').setView([52.47928, 13.45381], 13);

  L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
    maxZoom: 17,
    id: 'mapbox.streets'
  }).addTo(mymap);

  var vimfestIcon = L.icon({
    iconUrl: 'https://c1.staticflickr.com/5/4048/35700005035_c9eb7685b6_s.jpg',
    shadowSize:   [50, 64], // size of the shadow
  });

  L.marker([52.47928, 13.45381], {icon: vimfestIcon}).addTo(mymap)
  .bindPopup("<b>Vimfest 2017!</b><br />BÃ¼ro 2.0, Weigandufer 45, 12059 Berlin").openPopup();

  L.circle([51.508, -0.11], 500, {
    color: 'red',
    fillColor: '#f03',
    fillOpacity: 0.5
  }).addTo(mymap).bindPopup("I am a circle.");



  var popup = L.popup();

  function onMapClick(e) {
    popup
      .setLatLng(e.latlng)
      .setContent("You clicked the map at " + e.latlng.toString())
      .openOn(mymap);
  }

  mymap.on('click', onMapClick);

</script>
  </body>
  <!-- Piwik -->
  <script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="//vimfest.org/piwik/";
      _paq.push(['setTrackerUrl', u+'piwik.php']);
      _paq.push(['setSiteId', 1]);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
    })();

    // hide the navigation when it's clicked http://stackoverflow.com/a/19385791
    $(function() {
        $('.nav a').on('click', function(){
            if($('.navbar-toggle').css('display') !='none'){
                $(".navbar-toggle").trigger( "click" );
            }
        });
    });

  </script>
  <noscript><p><img src="//vimfest.org/piwik/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
  <!-- End Piwik Code -->
</html>
